
// PAGE TITLE
= Documentation Haut parleur



// OVERVIEW SECTION STARTS
[#overview]
--

[float]
=== Description
// Describe what this Reference term does, and what it is used for	►►►►► THIS SECTION IS MANDATORY ◄◄◄◄◄
Le haut parleur joue différents sons en fonction des données qu'il reçoit en Bluetooth. Il y a un son pour un taux de gaz trop élevé, un son pour indiquer qu'une personne est entrée ou qu'une fenêtre est ouverte par exemple
[%hardbreaks]

image::M5Stack.jpg[caption="", title="M5Stack classique"]
[%hardbreaks]


[float]
=== Setup
// Enter Reference term syntax, please specify all available parameters  ►►►►► THIS SECTION IS MANDATORY ◄◄◄◄◄
`void setup()`

// HOW TO USE SECTION STARTS
[#howtouse]
--

[float]
=== Code Setup
Initialisation du M5Stack et du Bluetooth

[source,arduino]
----
  M5.begin();
  M5.Power.begin();
  SerialBT.begin("Haut_parleur_BT"); //Bluetooth device name
----
[%hardbreaks]

[float]
=== Loop
// Enter Reference term syntax, please specify all available parameters  ►►►►► THIS SECTION IS MANDATORY ◄◄◄◄◄
`void loop()`

// HOW TO USE SECTION STARTS
[#howtouse]
--

[float]
=== Code Loop
Programme qui tourne en permanance sur le M5Stack. En fonction de ce qui est reçus. Il y a un son différent qui est joué 

[source,arduino]
----
  M5.Lcd.setCursor(0, 0, 2);
  M5.Lcd.printf("Haut parleur:\r\n");
  M5.Lcd.setCursor(0, 20, 2);
  if (SerialBT.available())
  {
    Serial.println(SerialBT.readString());
  }
  if(SerialBT.readString()=="PirEntreeBL")
  //if(M5.BtnB.wasPressed())
  {
    cptPersonnes++;
    M5.Speaker.tone(NOTE_DH3, 200); //frequency 3000, with a duration of 200ms
  }
  if(SerialBT.readString()=="PirSortieBL")
  //if(M5.BtnB.wasPressed())
  {
    cptPersonnes--;
    M5.Speaker.tone(NOTE_DL3, 200); //frequency 3000, with a duration of 200ms
  }
  if(SerialBT.readString()=="GazAlerte")
  {
    //M5.Lcd.printf("B gazal \r\n");
    M5.Speaker.tone(NOTE_D1, 200); //frequency 3000, with a duration of 200ms
  }
  if(cptPersonnes < 0){
    M5.Lcd.printf("Il y a 0 personnes");
  }else{
    sprintf(result,"Il y a %d personnes", cptPersonnes);
    M5.Lcd.printf(result);
  }
  M5.update();
----
[%hardbreaks]

--
[#see_also]
--

[float]
=== Voir d'autres documentations

[role="language"]
* #LIEN :# link:https://github.com/LENSAlex/ProjetIotia/blob/Code_Capteur/documentation/DocumentationPorte.adoc[Documentation Porte]
* #LIEN :# link:https://github.com/LENSAlex/ProjetIotia/blob/Code_Capteur/documentation/DocumentationGaz.adoc[Documentation détecteur de Gaz]
* #LIEN :# link:https://github.com/LENSAlex/ProjetIotia/blob/Code_Capteur/documentation/DocumentationPIR.adoc[Documentation PIR]


